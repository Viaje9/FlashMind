## 1. 狀態模型與選取場景擴充

- [x] 1.1 在 `speaking.component.ts` 擴充選取 target 型別，加入 AI 助手面板與主對話區的場景辨識欄位。
- [x] 1.2 新增發音按鈕所需狀態（loading/播放/暫停/重試）與對應的重設流程。
- [x] 1.3 調整選取動作入口，讓 action 文案可依場景切換（主對話區維持「翻譯」、AI 助手面板改為「發音」）。

## 2. AI 助手選取發音流程

- [x] 2.1 在 `speaking.component.ts` 接入 `TtsStore`（或等效播放入口），實作 AI 助手片段發音觸發方法。
- [x] 2.2 在 `speaking.component.html` 新增 AI 助手訊息可選取標記與發音按鈕狀態呈現（含 loading/播放/暫停/重試）。
- [x] 2.3 串接發音錯誤處理與重試行為，確保失敗後可再次播放。
- [x] 2.4 導入快取重用與請求競態保護，避免重複請求與過期狀態覆蓋。

## 3. iOS PWA 自訂選取整合

- [x] 3.1 延伸既有 token-based 自訂選取邏輯至 AI 助手面板 assistant 訊息。
- [x] 3.2 實作 iOS standalone 與非 iOS 的 selection fallback，確保兩種模式都可觸發「發音」。
- [x] 3.3 驗證選取清除、點擊外部、視窗失焦/滾動時，發音選取狀態會正確清除。

## 4. 測試與回歸驗證

- [x] 4.1 在 `speaking.component.spec.ts` 新增 AI 助手選取後顯示「發音」動作的測試。
- [x] 4.2 新增發音成功、失敗重試、選取變更競態處理的測試案例。
- [x] 4.3 執行目標測試並確認主對話區「選取翻譯」行為未回歸。
